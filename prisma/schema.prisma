// =========================
//   METRICS (NEW TABLES)
// =========================

model MetricsHourly {
  id           String   @id @default(cuid())
  hourUtc      DateTime @index                        // ตัวแทนชั่วโมง UTC: 2025-11-11T10:00:00Z
  userId       String?  @index
  // หมายเหตุ: ถ้าต้องการผูก relation กับ User แบบ optional:
  user         User?    @relation(fields: [userId], references: [id])

  pointsEarned Int      @default(0)
  uptimePct    Float?   // 0..100
  avgBandwidth Float?   // Mbps
  qfScore      Float?
  trustScore   Float?

  createdAt    DateTime @default(now())

  @@unique([hourUtc, userId], name: "hourUtc_userId_unique") // ให้ upsert ได้คีย์เดียวต่อชั่วโมง/ต่อผู้ใช้
}

model MetricsDaily {
  id           String   @id @default(cuid())
  dayUtc       DateTime @index                        // ตัวแทนวัน UTC: 2025-11-11T00:00:00Z
  userId       String?  @index
  user         User?    @relation(fields: [userId], references: [id])

  pointsEarned Int      @default(0)
  uptimePct    Float?
  avgBandwidth Float?
  qfScore      Float?
  trustScore   Float?

  createdAt    DateTime @default(now())

  @@unique([dayUtc, userId], name: "dayUtc_userId_unique")
}
